import json
import pickle
import struct

def stringToByte(text):
    while len(text) % 8 != 0:
        text += "0"

    bytes = bytearray()
    for i in range(0, len(text), 8):
        byte = text[i:i+8]
        bytes.append(int(byte,2))

    return bytes

def byteToString(bytes):
    text = ""
    bits = bin(0)
    for byte in bytes:
        bits = bin(byte)[2:]
        bits = bits.zfill(8)
        text += bits

    return text


def guardar_datos_huffman(diccionario, cadena_bits, nombre_archivo):
    """Guarda los datos de Huffman en un archivo binario.

    Args:
        diccionario: Diccionario con el código Huffman.
        longitud_cadena: Longitud de la cadena de bits codificada.
        cadena_bits: Cadena de bits codificada.
        nombre_archivo: Nombre del archivo a crear.
    """

    papa = json.dumps(diccionario).encode('utf-8')
    # Serializar el diccionario
    cadena_bits = stringToByte(cadena_bits)



    

    # Escribir los datos en el archivo
    with open(nombre_archivo, 'wb') as f:
        f.write(cadena_bits)

# Ejemplo de uso:
diccionario = {'e': '000', 'g': '001000', 'b': '0010010', '©': '0010011', 't': '00101', 's': '0011', 'r': '0100', 'd': '01010', 'm': '01011', 'n': '0110', 'p': '011100', '±': '01110100', '?': '01110101', 'N': '0111011', '¿': '01111000', 'Â': '01111001', 'T': '011110100', 'E': '0111101010', 'j': '0111101011', 'P': '011110110', 'z': '0111101110', 'M': '0111101111', 'c': '011111', 'a': '1000', 'l': '10010', '³': '10011000', 'L': '1001100100', 'J': '1001100101', 'h': '100110011', ',': '1001101', '\xad': '100111', '\n': '10100', 'Ã': '10101', 'S': '1011000', 'v': '1011001', '¡': '10110100', 'º': '101101010', 'Q': '101101011', 'Y': '1011011', 'i': '10111', ' ': '110', 'o': '1110', 'u': '11110', 'q': '111110', 'y': '111111'}

cadena_bits = "10110001110111111110100101000110011100010000000100011110011000101100011001010000100101100101110111100101001010101100110000110101001011000101110000101101110001000001101001010001101011101100010100001000100111000100010000111111011110101100110000110101000111011111011001000000011011100111001100101010000011110111110111100001100011101011001111100111001110010011111011110000110001110101100111101000111100101111000101101111011111011110101010010011100110111011111011110101010010011110011100111001010010010101100111100000111100010110101101101010110010100000111111011101000111010110100101100010111110111111111011001101110110001010001101011001111011111111010001101110101011001110100101000111011111011001011000110000011000101101110000110010100000011101001011011110011011110011001111110001100011000010010101001001111010010111011011111011110000110000001101110000001001000001111001010000110010111010110011110100100110010110000101110101101101000011100110111011111110001100101100011010110011000001111010001100111111110011011100111110000100101000111011101111010101110100111011011111111010011001111100101100100100100000110011100111100000101011101100011000010010100011101111101100101100011011110001100000111101111111101000011100100001000010100000111100101000011000101101111010010110111101011001101011001111100111111110010111110110100010010001000111101011100001101101000011100010000001100101010111101011001100010100100110010011101101111101111000011001101000010101011100011010010000110000011000110001010101110100101011001100010100011101111101100101100011000001100010110111000011001010000011010011011100110111011000000110010111101111111101000111110111101010110011110100101101111011111111101100011111010010111011011111011110101110000100111011000110000100110010000010001001010100101101111000110000110001011011101001100001001011001011111100110010101110110101110010001111010001001010100101101011111100001101001011100011110111000101010011100011100110111000110000010001111010111010011000111011100001011011100010000011010000011101011001111010001111001011110000111101101110010011011111011110101010010011110111111111011000101000011001010010010101100111100011011111011110000110011111100001011001001010111100001000111010110100011101110000101010111000110010111010110110100001111010010111011010110011000110100011010111011000101000011000101100001001010010110111100110111011000001100010110111000011001010000011011011111011110000110001110111001000111011010001111101111010101100111101001011011110001011010110110101011010110010000011110100101110110111110111100001100001001010010111000111100110111100110011111100011010110010000110101000111101000001100101010000100101011001111000110000100101100111111011100001101100111001110010011001111110111000011010100011110111100011001111111100110111001111100000111001101110111111110111111100011001101110110100110011100011111111000101000010111110010010100101101111101100101111100011001010100100001001010110011110001101001011101101111101111000011000111110111111101001011000101111100010110101101101010110101100110111000011000000111100101011100110010100001101011001111011111110100011101111101100101100011010001001001111110000110011110111010000110101001011000101111100000100000001111001011101111101000010111011100100011101001101110010110000111101011111001001010001111001011110001011010111111010101001001111000111000001001001001010110110100011011001010000100101100101110001001011011111111000010010110001001010111000011001110101101001011011111011001101110110001111101111111101001011101101111101111000011010110010000110101000111101001110010101110110111100110110010111111001100101011101100101011110010001011101110000110010101110110111111110111111111011000111011100100011101100011111010101011101001000011001010111010011011100111001110010011111011110000101001011000111100011110011100100010010100000100100100100000111100011111100011111100100010010000110110010110000110001011011101001000001111011111011110000110011011110011001111110001100111110100000000010010101001001110100101101111011111111101100011111010010111011011111011110101110000100111011000110000100110010000010001001010100101101111000110000110001011011101001100001001011001011111100110010101110110101110010001111010001001010100101101011111100001100110111000111110001010100111000111001101110011100111001001100001001010010111000111001101110011100111001001100101110101100111101000111100101111000011110110111001001101111101111010101001001111011111111101100010100001100101001001010110011110001101111101111000011001111110000101100100101011110000100011101011010001110111000010101011100011001011101011011010000111101001011101101011001100011010001101011101100010100001100010110000100101000111101010001100101111011111111000111110100101110110111111110001110111001000111011010001111101111010101100111101001011000111010010111011011111111101100000011001011110111111110100011111011110101011001111010010110001011100100011101101000111110111101010110011110100101100010111001000111011010001111101111010101100111"
print(stringToByte(cadena_bits))
guardar_datos_huffman(diccionario, cadena_bits, "ArqHardware/Pruebas/wi.bin")
